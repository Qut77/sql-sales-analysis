# sql-sales-analysis
SQL-–ø—Ä–æ–µ–∫—Ç –∞–Ω–∞–ª–∏–∑–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö DVD Rental: –æ—Ç—á—ë—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –≤—ã—Ä—É—á–∫–µ, –∫–ª–∏–µ–Ω—Ç–∞–º –∏ –∂–∞–Ω—Ä–∞–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JOIN, CTE –∏ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
# SQL Sales Analysis (DVD Rental)

–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ SQL –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—á–µ–±–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö **DVD Rental** (PostgreSQL).  
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å SQL: JOIN, –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã, –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, CTE –∏ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.  
–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ SQL.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- `01_basic_queries.sql` ‚Äî –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–≤—ã–±–æ—Ä–∫–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞).
- `02_aggregations.sql` ‚Äî –∞–≥—Ä–µ–≥–∞—Ç—ã (—Å—É–º–º—ã, —Å—Ä–µ–¥–Ω–∏–µ, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏).
- `03_joins_subqueries.sql` ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.
- `04_cte_window.sql` ‚Äî CTE –∏ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.
- `05_final_report.sql` ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ (–≤—ã—Ä—É—á–∫–∞, –¢–û–ü-—ã, –Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã).

---

## üóÑÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –±–∞–∑–∞
DVD Rental ‚Äî –ø—Ä–∏–º–µ—Ä —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è PostgreSQL.  
–°–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–±–ª–∏—Ü—ã:
- **film, category, film_category** ‚Äî —Ñ–∏–ª—å–º—ã –∏ –∂–∞–Ω—Ä—ã,
- **customer, address, city** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã,
- **rental, payment** ‚Äî –∞—Ä–µ–Ω–¥—ã –∏ –ø–ª–∞—Ç–µ–∂–∏,
- **staff, store** ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏ –º–∞–≥–∞–∑–∏–Ω—ã.

[–°–∫–∞—á–∞—Ç—å –±–∞–∑—É dvdrental](https://www.postgresqltutorial.com/postgresql-getting-started/postgresql-sample-database/)

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä 1. –¢–û–ü-5 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —Å—É–º–º–µ –∞—Ä–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤**
```sql
SELECT 
    c.customer_id,
    c.first_name,
    c.last_name,
    SUM(p.amount) AS total_spent
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY total_spent DESC
LIMIT 5;
